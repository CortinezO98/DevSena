{% extends 'base/base.html' %}
{% load static %}
{% load mytags %}

{% block main %}
    <div class="row animate__animated animate__fadeIn">
        <div class="row p-0">
            <div class="col text-end mt-3 p-0">                
                {% if request.session.usuarioActual %}
                    <div class="mensaje-bienvenida">
                        Bienvenido, <strong>{{ request.session.usuarioActual.nombre }}</strong>
                        <a href="{% url 'cerrarSesion' %}" class="btn btn-outline-danger btn-sm ms-2">Cerrar sesión</a>
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <a href="#" data-bs-whatever="{% url 'abrirUrl' 'Lenguaje de señas' 'https://webrtc.inconcertcc.com/iq/sena/videocall/index.html'|base64encode %}" class="list-group-item list-group-item-action" data-bs-toggle="modal" data-bs-target="#iframeModal">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-hands-asl-interpreting fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Lengua de señas
                    </div>
                </div>
            </a>
        </div>
        
        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Formación para el trabajo' 'formajob' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-graduation-cap fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Formación para el trabajo
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Gestión para el empleo Sena' 'gesples' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-business-time fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Gestión para el empleo Sena
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Certificación de competencias' 'cercom' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-file-circle-check fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Certificación de competencias
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Senatronica' 'setroc' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-microchip fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Senatronica
                    </div>
                </div>
            </a>
        </div>


        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'CampeSENA' 'CampeSENA' %}" class="a-none" >
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        
                        <img src="{% static 'img/campesena_logo2.png' %}" class="" height="81px" alt="logo">
                    </div>
                    <div class="card-footer text-bg-success">
                        CampeSENA
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Emprendimiento emprende rural' 'enrural' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-regular fa-lightbulb fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Emprendimiento emprende rural
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Bienestar al aprendiz' 'Bienestar' %}" class="a-none" >
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-heart-pulse fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Bienestar al aprendiz
                    </div>
                </div>
            </a>
        </div>


        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Otros servicios' 'Servicios' %}" class="a-none" >
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-hand-holding-heart fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Otros servicios
                    </div>
                </div>
            </a>
        </div>

        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Empresarios' 'Empresarios' %}" class="a-none" >
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-users fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Empresarios
                    </div>
                </div>
            </a>
        </div>


        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'PQRS' 'Pqr' %}" class="a-none" >
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-headset fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        PQRS
                    </div>
                </div>
            </a>
        </div>


        <div class="col-6 col-md-4 col-lg-2">
            <a href="{% url 'abrirUrl' 'Canales de Atencion' 'Catencion' %}" class="a-none">
                <div class="card border-success card-link">
                    <div class="card-body rounded-top text-center py-4">
                        <i class="fa-solid fa-square-phone fa-5x text-secondary"></i>
                    </div>
                    <div class="card-footer text-bg-success">
                        Canales de Atención
                    </div>
                </div>
            </a>
        </div>
    </div>

    <div class="modal fade" id="iframeModal" tabindex="-1" aria-labelledby="iframeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="iframeModalLabel"></h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <iframe src="" frameborder="0" width="100%" height="100%"></iframe>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var enlaces = document.querySelectorAll('.abrir-ventana');
            enlaces.forEach(function(enlace) {
                enlace.addEventListener('click', function(event) {
                    event.preventDefault();
                    var url = this.getAttribute('data-url');
                    abrirVentanaEmergente(url);
                });
            });
        });
    </script>
    <script>
        
        let tiempoInactividad = 180000; 
        let temporizadorInactivo;

        function reiniciarTemporizador() {
            clearTimeout(temporizadorInactivo);
            temporizadorInactivo = setTimeout(redirigirAlIndex, tiempoInactividad);
        }

        function redirigirAlIndex() {
            window.location.href = "{% url 'cerrarSesion' %}";
        }

        document.addEventListener("DOMContentLoaded", function () {
            reiniciarTemporizador();
            document.addEventListener("mousemove", reiniciarTemporizador);
            document.addEventListener("keydown", reiniciarTemporizador);
            document.addEventListener("click", reiniciarTemporizador);
        });


    </script>

    <script>
        
        const iframeModal = document.getElementById('iframeModal');
        if (iframeModal) {
            iframeModal.addEventListener('show.bs.modal', event => {
                const button = event.relatedTarget;
                const url = button.getAttribute('data-bs-whatever');
                const btnText = button.innerText;
                const modalTitle = iframeModal.querySelector('.modal-title');
                const modalBodyInput = iframeModal.querySelector('.modal-body iframe');
    
                modalTitle.textContent = `${btnText}`;
                modalBodyInput.src = url;
            });
        }
    </script>

{% endblock %}